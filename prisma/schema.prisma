generator client {
  provider             = "prisma-client-py"
  recursive_type_depth = 5
  previewFeatures      = ["postgresqlExtensions"]
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")   // Uses port 6543 for the app
}

// ==========================================
// Scraped Properties from PropertyPro.com
// ==========================================
model PropertyPro {
  id                  String         @id @default(cuid())

  // Basic Info
  title               String
  url                 String         @unique
  description         String?
  address             String
  addressNumber       String?
  city                String
  state               String?
  country             String         @default("Nigeria")
  latitude            Float?
  longitude           Float?
  // location            Unsupported("geometry(Point, 4326)")?


  // Media
  images              String[]       @default([])
  videos              String[]       @default([])
  threeDModel         String?

  // Property Details
  price               BigInt
  beds                Int
  baths               Int
  sqft                Int?
  yearBuilt           Int?

  // Features & Amenities
  amenities           String[]       @default([])
  petFriendly         Boolean        @default(false)
  furnished           Boolean        @default(false)
  airConditioned      Boolean        @default(false)
  
  // Lease Terms
  minLeaseTerm        Int            @default(12) // months
  availabilityDate    DateTime?
  leaseLengthMonths   Int?
  utilitiesIncluded   String[]       @default([])

  // Tenant Requirements
  smokingAllowed      Boolean        @default(false)
  visitorPolicy       String?        // STRICT, MODERATE, OPEN

  // Engagement Metrics
  views               Int            @default(0)
  favoriteCount       Int            @default(0)
  matchCount          Int            @default(0)

  // Status         
  publishedAt         DateTime       @default(now())

  createdAt           DateTime       @default(now())
  updatedAt           DateTime       @updatedAt

  // Relations
  swipes              Swipe[]
  matches             Match[]
  favorites           Favorite[]

  @@index([city])
  @@index([price])
  @@index([beds])
  @@index([latitude, longitude])
  @@index([publishedAt])
}


// ==========================================
// Scraped Properties from Jiji.ng
// ==========================================
model Jiji {
  id                  String         @id @default(cuid())

  // Basic Info
  title               String
  url                 String         @unique
  description         String?
  address             String
  addressNumber       String?
  city                String
  state               String?
  country             String         @default("Nigeria")
  latitude            Float?
  longitude           Float?
  // location            Unsupported("geometry(Point, 4326)")?


  // Media
  images              String[]       @default([])
  videos              String[]       @default([])
  threeDModel         String?

  // Property Details
  price               BigInt
  beds                Int
  baths               Int
  sqft                Int?
  yearBuilt           Int?

  // Features & Amenities
  amenities           String[]       @default([])
  petFriendly         Boolean        @default(false)
  furnished           Boolean        @default(false)
  airConditioned      Boolean        @default(false)
  
  // Lease Terms
  minLeaseTerm        Int            @default(12) // months
  availabilityDate    DateTime?
  leaseLengthMonths   Int?
  utilitiesIncluded   String[]       @default([])

  // Tenant Requirements
  smokingAllowed      Boolean        @default(false)
  visitorPolicy       String?        // STRICT, MODERATE, OPEN

  // Engagement Metrics
  views               Int            @default(0)
  favoriteCount       Int            @default(0)
  matchCount          Int            @default(0)

  // Status         
  publishedAt         DateTime       @default(now())

  createdAt           DateTime       @default(now())
  updatedAt           DateTime       @updatedAt

  // Relations
  swipes              Swipe[]
  matches             Match[]
  favorites           Favorite[]

  @@index([city])
  @@index([price])
  @@index([beds])
  @@index([latitude, longitude])
  @@index([publishedAt])
}

model Swipe {
  id            String      @id @default(cuid())
  propertyPro   PropertyPro? @relation(fields: [propertyProId], references: [id])
  propertyProId String?
  jiji          Jiji?        @relation(fields: [jijiId], references: [id])
  jijiId        String?
  createdAt     DateTime     @default(now())
}

model Match {
  id            String      @id @default(cuid())
  propertyPro   PropertyPro? @relation(fields: [propertyProId], references: [id])
  propertyProId String?
  jiji          Jiji?        @relation(fields: [jijiId], references: [id])
  jijiId        String?
  createdAt     DateTime     @default(now())
}

model Favorite {
  id            String      @id @default(cuid())
  propertyPro   PropertyPro? @relation(fields: [propertyProId], references: [id])
  propertyProId String?
  jiji          Jiji?        @relation(fields: [jijiId], references: [id])
  jijiId        String?
  createdAt     DateTime     @default(now())
}